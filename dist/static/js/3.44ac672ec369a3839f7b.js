webpackJsonp([3],{"22O3":function(t,e,n){"use strict";var i=n("3cXf"),s=n.n(i),r=window.localStorage;e.a={set:function(t,e){void 0!==e&&r.setItem(t,function(t){return s()(t)}(e))},get:function(t,e){var n=function(t){if("string"!=typeof t)return;try{return JSON.parse(t)}catch(e){return t||void 0}}(r.getItem(t));return void 0===n?e:n},remove:function(t){r.removeItem(t)},clear:function(){r.clear()}}},"3cXf":function(t,e,n){t.exports={default:n("L+o2"),__esModule:!0}},BbRt:function(t,e){},"L+o2":function(t,e,n){var i=n("ZuHZ"),s=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},LChD:function(t,e){},O8hO:function(t,e){},ZXAo:function(t,e){},aozZ:function(t,e){},ar59:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("8MDr"),s={name:"MeConfirm",props:{title:{type:String,default:""},msg:{type:String,default:"确定执行此操作吗？"},cancelBtnText:{type:String,default:"取消"},confirmBtnText:{type:String,default:"确定"}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},cancel:function(){this.hide(),this.$emit("cancel")},confirm:function(){this.hide(),this.$emit("confirm")}}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"mine-confirm"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"mine-confirm-wrapper"},[n("div",{staticClass:"mine-confirm"},[t.title?n("div",{staticClass:"mine-confirm-title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),n("div",{staticClass:"mine-confirm-msg"},[t._v(t._s(t.msg))]),t._v(" "),n("div",{staticClass:"mine-confirm-btns"},[n("button",{staticClass:"mine-confirm-btn mine-confirm-cancel",on:{click:t.cancel}},[t._v(t._s(t.cancelBtnText))]),t._v(" "),n("button",{staticClass:"mine-confirm-btn mine-confirm-ok",on:{click:t.confirm}},[t._v(t._s(t.confirmBtnText))])])])])])},staticRenderFns:[]};var o=n("C7Lr")(s,r,!1,function(t){n("uOJv")},"data-v-4e7d4444",null).exports,a=n("/l8+"),c=n("Fk3l"),l={name:"SearchHeader",components:{MeNavbar:a.a,MeSearchBox:c.a},methods:{query:function(t){this.$emit("query",t)},goBack:function(){this.$router.back()}}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("me-navbar",{staticClass:"header"},[e("i",{staticClass:"iconfont icon-back",attrs:{slot:"left"},on:{click:this.goBack},slot:"left"}),this._v(" "),e("me-search-box",{attrs:{slot:"center",placeholder:"开学季有礼，好货5折起"},on:{query:this.query},slot:"center"})],1)},staticRenderFns:[]};var h=n("C7Lr")(l,u,!1,function(t){n("O8hO")},"data-v-02559e06",null).exports,f=n("rVsN"),m=n.n(f),d=n("odKQ"),v=n("I29D"),g=n.n(v),y=n("cQcd"),_=n("T452"),p=n("22O3"),C={methods:{$_selectItem:function(t){var e=p.a.get("mall-search-history-keyword-key",[]);0!==e.length&&(e=e.filter(function(e){return e!==t})),e.unshift(t),p.a.set("mall-search-history-keyword-key",e)}}},w={name:"SearchHot",components:{MeLoading:d.a},mixins:[C],data:function(){return{hot:[]}},methods:{getSearchHotContent:function(){var t=this;return g.a.get("http://www.imooc.com/api/search/hot").then(function(t){if(200===t.status)return t.data.hotKeyWord;throw new Error("未能获取到热门搜索数据")}).catch(function(t){t&&console.log(t)}).then(function(e){return new m.a(function(n){e&&(t.hot=e.def,n())})})}},created:function(){var t=this;this.getSearchHotContent().then(function(){t.$emit("loaded")})}},k={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hot"},[n("h4",{staticClass:"hot-title"},[t._v("热门搜索")]),t._v(" "),t.hot.length?n("ul",{staticClass:"hot-list"},t._l(t.hot,function(e,i){return n("li",{key:i,staticClass:"hot-item",on:{click:function(n){return t.$_selectItem(e)}}},[t._v(t._s(e))])}),0):n("div",{staticClass:"loading-container"},[n("me-loading")],1)])},staticRenderFns:[]};var S=n("C7Lr")(w,k,!1,function(t){n("aozZ")},"data-v-606d46b4",null).exports,b={name:"SearchHistory",mixins:[C],data:function(){return{history:[]}},methods:{update:function(){this.getSearchHistory()},clearHistory:function(){p.a.remove("mall-search-history-keyword-key")},getSearchHistory:function(){this.history=p.a.get("mall-search-history-keyword-key",[])},removeItem:function(t){var e=this;this.history=this.history.filter(function(e){return e!==t}),p.a.set("mall-search-history-keyword-key",this.history),setTimeout(function(){e.$emit("remove-item")},100)},showConfirm:function(){this.$emit("show-confirm")}},created:function(){this.getSearchHistory()}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.history.length?n("div",{staticClass:"history"},[n("h4",{staticClass:"history-title"},[t._v("历史搜索")]),t._v(" "),n("transition-group",{staticClass:"g-list",attrs:{tag:"ul",name:"list"}},t._l(t.history,function(e){return n("li",{key:e,staticClass:"g-list-item",on:{click:function(n){return t.$_selectItem(e)}}},[n("span",{staticClass:"g-list-text"},[t._v(t._s(e))]),t._v(" "),n("i",{staticClass:"iconfont icon-delete",on:{click:function(n){return n.stopPropagation(),t.removeItem(e)}}})])}),0),t._v(" "),n("a",{staticClass:"history-btn",attrs:{href:"javascript:;"},on:{click:t.showConfirm}},[n("i",{staticClass:"iconfont icon-clear"}),t._v("清空历史搜索")])],1):t._e()},staticRenderFns:[]};var $=n("C7Lr")(b,x,!1,function(t){n("BbRt")},"data-v-3fc01843",null).exports,H={name:"SearchResult",components:{MeLoading:d.a},props:{query:{type:String,default:""}},mounted:function(){this.getResult(this.query)},watch:{query:function(t){this.getResult(t)}},data:function(){return{results:[],loading:!1}},mixins:[C],methods:{getResult:function(t){var e=this;t&&(this.loading=!0,function(t){var e={q:t,code:"utf-8",area:"c2c",nick:"",sid:null};return Object(y.a)("https://suggest.taobao.com/sug",e,_.e).then(function(t){if(t.result)return t.result;throw new Error("没有成功获取到数据！")}).catch(function(t){t&&console.log(t)}).then(function(t){return new m.a(function(e){e(t)})})}(t).then(function(t){e.results=t,e.loading=!1}))}}},q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"result"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"loading-container"},[n("me-loading")],1),t._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.results.length,expression:"!loading && results.length"}],staticClass:"g-list"},t._l(t.results,function(e,i){return n("li",{key:i,staticClass:"g-list-item",on:{click:function(n){return t.$_selectItem(e[0])}}},[n("span",{staticClass:"g-list-text"},[t._v(t._s(e[0]))])])}),0),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.results.length,expression:"!loading && !results.length"}],staticClass:"no-result"},[t._v("没有结果")])])},staticRenderFns:[]};var O=n("C7Lr")(H,q,!1,function(t){n("LChD")},"data-v-f2476166",null).exports,R={name:"Search",components:{MeScroll:i.a,MeConfirm:o,searchHeader:h,SearchHot:S,SearchHistory:$,SearchResult:O},data:function(){return{query:""}},methods:{getQuery:function(t){this.query=t},showConfirm:function(){this.$refs.confirm.show()},clearAllHistorys:function(){this.$refs.history.clearHistory(),this.$refs.history.update()},updateScroll:function(){this.$refs.scroll.update()}}},L={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"search"}},[n("div",{staticClass:"search"},[n("header",{staticClass:"g-header-container"},[n("search-header",{on:{query:t.getQuery}})],1),t._v(" "),n("div",{staticClass:"g-content-container"},[t.query.length?n("search-result",{attrs:{query:t.query}}):n("me-scroll",{ref:"scroll"},[n("search-hot",{on:{loaded:t.updateScroll}}),t._v(" "),n("search-history",{ref:"history",on:{"show-confirm":t.showConfirm,"remove-item":t.updateScroll}})],1)],1),t._v(" "),n("me-confirm",{ref:"confirm",attrs:{msg:"确认清空吗？"},on:{confirm:t.clearAllHistorys}})],1)])},staticRenderFns:[]};var I=n("C7Lr")(R,L,!1,function(t){n("ZXAo")},"data-v-057a070d",null);e.default=I.exports},uOJv:function(t,e){}});
//# sourceMappingURL=3.44ac672ec369a3839f7b.js.map